{% extends "base.html" %}

{% block content %}
<div class="container mx-auto p-4">
    <h1 class="text-3xl font-bold text-[#052E87] mb-4">PDF Merger</h1>
    <p class="text-gray-700">Merge multiple PDF files into a single PDF.</p>

    <!-- Drag-and-Drop Area -->
    <form method="POST" enctype="multipart/form-data" class="space-y-4">
        <div id="drop-area" class="border-2 border-dashed border-gray-400 p-6 text-center bg-gray-100 rounded-lg">
            <p class="text-gray-600">Drag PDF files here or click to upload</p>
            <input type="file" id="pdf_files" name="pdf_files" multiple accept=".pdf" class="hidden">
            <button type="button" id="add-more" class="mt-4 bg-[#052E87] text-white py-2 px-4 rounded-lg hover:bg-[#041f5e] transition duration-300">
                Add More Files
            </button>
        </div>

        <!-- File List -->
        <div id="file-list" class="mt-4">
            <!-- Files will be listed here -->
        </div>

        <!-- Output Filename -->
        <div class="mt-4">
            <label for="output_filename" class="block text-gray-700">Output Filename:</label>
            <input type="text" id="output_filename" name="output_filename" placeholder="merged.pdf" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#052E87]">
        </div>

        <!-- Merge Button -->
        <button type="submit" class="w-full bg-[#052E87] text-white py-2 rounded-lg hover:bg-[#041f5e] transition duration-300">
            Merge Files
        </button>
    </form>
</div>

<!-- JavaScript for Drag-and-Drop -->
<script>
    const dropArea = document.getElementById('drop-area');
    const fileInput = document.getElementById('pdf_files');
    const fileList = document.getElementById('file-list');
    const addMoreButton = document.getElementById('add-more');

    // Prevent default drag behaviors
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    // Highlight drop area when file is dragged over
    ['dragenter', 'dragover'].forEach(eventName => {
        dropArea.addEventListener(eventName, () => dropArea.classList.add('bg-gray-200'), false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
        dropArea.addEventListener(eventName, () => dropArea.classList.remove('bg-gray-200'), false);
    });

    // Handle dropped files
    dropArea.addEventListener('drop', handleDrop, false);
    dropArea.addEventListener('click', () => fileInput.click(), false);
    addMoreButton.addEventListener('click', () => fileInput.click(), false);

    function handleDrop(e) {
        const files = e.dataTransfer.files;
        handleFiles(files);
    }

    // Handle file input change
    fileInput.addEventListener('change', (e) => {
        const files = e.target.files;
        handleFiles(files);
    });

    // Display file names
    function handleFiles(files) {
        for (const file of files) {
            const fileItem = document.createElement('div');
            fileItem.textContent = file.name;
            fileList.appendChild(fileItem);
        }
    }
</script>
{% endblock %}